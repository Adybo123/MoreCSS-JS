function throwError (lineNumber, line, errType, errString) {
  throw new Error(`MoreCSS - ${errType} - ${errString}
at line ${lineNumber + 1},
'${line}'`)
}

// Atom is dying help
let pantones = ['Yellow C', 'Yellow 012 C', 'Orange 021 C', 'Warm Red C', 'Red 032 C', 'Rubine Red C', 'Rhodamine Red C', 'Purple C', 'Violet C', 'Blue 072 C', 'Reflex Blue C', 'Process Blue C', 'Green C', 'Black C', 'Yellow 0131 C', 'Red 0331 C', 'Magenta 0521 C', 'Violet 0631 C', 'Blue 0821 C', 'Green 0921 C', 'Black 0961 C', '801 C', '802 C', '803 C', '804 C', '805 C', '806 C', '807 C', '871 C', '872 C', '873 C', '874 C', '875 C', '876 C', '877 C', 'Medium Yellow C', 'Bright Orange C', 'Bright Red C', 'Strong Red C', 'Pink C', 'Medium Purple C', 'Dark Blue C', 'Medium Blue C', 'Bright Green C', 'Neutral Black C', '100 C', '101 C', '102 C', '103 C', '104 C', '105 C', '7401 C', '7402 C', '7403 C', '7404 C', '7405 C', '7406 C', '7407 C', '106 C', '107 C', '108 C', '109 C', '110 C', '111 C', '112 C', '113 C', '114 C', '115 C', '116 C', '117 C', '118 C', '119 C', '127 C', '128 C', '129 C', '130 C', '131 C', '132 C', '133 C', '1205 C', '1215 C', '1225 C', '1235 C', '1245 C', '1255 C', '1265 C', '120 C', '121 C', '122 C', '123 C', '124 C', '125 C', '126 C', '7548 C', '7549 C', '7550 C', '7551 C', '7552 C', '7553 C', '7554 C', '7555 C', '7556 C', '7557 C', '7558 C', '7559 C', '7560 C', '7561 C', '134 C', '135 C', '136 C', '137 C', '138 C', '139 C', '140 C', '1345 C', '1355 C', '1365 C', '1375 C', '1385 C', '1395 C', '1405 C', '141 C', '142 C', '143 C', '144 C', '145 C', '146 C', '147 C', '7408 C', '7409 C', '7410 C', '7411 C', '7412 C', '7413 C', '7414 C', '7562 C', '7563 C', '7564 C', '7565 C', '7566 C', '7567 C', '7568 C', '7569 C', '7570 C', '7571 C', '7572 C', '7573 C', '7574 C', '7575 C', '712 C', '713 C', '714 C', '715 C', '716 C', '717 C', '718 C', '148 C', '149 C', '150 C', '151 C', '152 C', '153 C', '154 C', '155 C', '156 C', '157 C', '158 C', '159 C', '160 C', '161 C', '1485 C', '1495 C', '1505 C', '1525 C', '1535 C', '1545 C', '1555 C', '1565 C', '1575 C', '1585 C', '1595 C', '1605 C', '1615 C', '162 C', '163 C', '164 C', '165 C', '166 C', '167 C', '168 C', '7576 C', '7577 C', '7578 C', '7579 C', '7580 C', '7581 C', '7582 C', '1625 C', '1635 C', '1645 C', '1655 C', '1665 C', '1675 C', '1685 C', '169 C', '170 C', '171 C', '172 C', '173 C', '174 C', '175 C', '7583 C', '7584 C', '7585 C', '7586 C', '7587 C', '7588 C', '7589 C', '7590 C', '7591 C', '7592 C', '7593 C', '7594 C', '7595 C', '7596 C', '7597 C', '7598 C', '7599 C', '7600 C', '7601 C', '7602 C', '7603 C', '7604 C', '7605 C', '7606 C', '7607 C', '7608 C', '7609 C', '7610 C', '7611 C', '7612 C', '7613 C', '7614 C', '7615 C', '7616 C', '7617 C', '7520 C', '7521 C', '7522 C', '7523 C', '7524 C', '7525 C', '7526 C', '489 C', '488 C', '487 C', '486 C', '485 C', '484 C', '483 C', '176 C', '177 C', '178 C', '179 C', '180 C', '181 C', '1765 C', '1775 C', '1785 C', '1788 C', '1795 C', '1805 C', '1815 C', '1767 C', '1777 C', '1787 C', '1797 C', '1807 C', '1817 C', '7618 C', '7619 C', '7620 C', '7621 C', '7622 C', '7623 C', '7624 C', '7625 C', '7626 C', '7627 C', '7628 C', '7629 C', '7630 C', '7631 C', '7415 C', '7416 C', '7417 C', '7418 C', '7419 C', '7420 C', '7421 C', '182 C', '183 C', '184 C', '185 C', '186 C', '187 C', '188 C', '196 C', '197 C', '198 C', '199 C', '200 C', '201 C', '202 C', '189 C', '190 C', '191 C', '192 C', '193 C', '194 C', '195 C', '1895 C', '1905 C', '1915 C', '1925 C', '1935 C', '1945 C', '1955 C', '705 C', '706 C', '707 C', '708 C', '709 C', '710 C', '711 C', '698 C', '699 C', '700 C', '701 C', '702 C', '703 C', '704 C', '203 C', '204 C', '205 C', '206 C', '207 C', '208 C', '209 C', '210 C', '211 C', '212 C', '213 C', '214 C', '215 C', '216 C', '7422 C', '7423 C', '7424 C', '7425 C', '7426 C', '7427 C', '7428 C', '7632 C', '7633 C', '7634 C', '7635 C', '7636 C', '7637 C', '7638 C', '217 C', '218 C', '219 C', '220 C', '221 C', '222 C', '7639 C', '7640 C', '7641 C', '7642 C', '7643 C', '7644 C', '7645 C', '223 C', '224 C', '225 C', '226 C', '227 C', '228 C', '229 C', '230 C', '231 C', '232 C', '233 C', '234 C', '235 C', '670 C', '671 C', '672 C', '673 C', '674 C', '675 C', '676 C', '677 C', '678 C', '679 C', '680 C', '681 C', '682 C', '683 C', '684 C', '685 C', '686 C', '687 C', '688 C', '689 C', '690 C', '510 C', '509 C', '508 C', '507 C', '506 C', '505 C', '504 C', '7429 C', '7430 C', '7431 C', '7432 C', '7433 C', '7434 C', '7435 C', '691 C', '692 C', '693 C', '694 C', '695 C', '696 C', '697 C', '496 C', '495 C', '494 C', '493 C', '492 C', '491 C', '490 C', '503 C', '502 C', '501 C', '500 C', '499 C', '498 C', '497 C', '5035 C', '5025 C', '5015 C', '5005 C', '4995 C', '4985 C', '4975 C', '236 C', '237 C', '238 C', '239 C', '240 C', '241 C', '242 C', '2365 C', '2375 C', '2385 C', '2395 C', '2405 C', '2415 C', '2425 C', '243 C', '244 C', '245 C', '246 C', '247 C', '248 C', '249 C', '7646 C', '7647 C', '7648 C', '7649 C', '7650 C', '7651 C', '7652 C', '250 C', '251 C', '252 C', '253 C', '254 C', '255 C', '517 C', '516 C', '515 C', '514 C', '513 C', '512 C', '511 C', '7436 C', '7437 C', '7438 C', '7439 C', '7440 C', '7441 C', '7442 C', '2562 C', '2572 C', '2582 C', '2592 C', '2602 C', '2612 C', '2622 C', '7653 C', '7654 C', '7655 C', '7656 C', '7657 C', '7658 C', '7659 C', '524 C', '523 C', '522 C', '521 C', '520 C', '519 C', '518 C', '5245 C', '5235 C', '5225 C', '5215 C', '5205 C', '5195 C', '5185 C', '5175 C', '5165 C', '5155 C', '5145 C', '5135 C', '5125 C', '5115 C', '531 C', '530 C', '529 C', '528 C', '527 C', '526 C', '525 C', '256 C', '257 C', '258 C', '259 C', '260 C', '261 C', '262 C', '2563 C', '2573 C', '2583 C', '2593 C', '2603 C', '2613 C', '2623 C', '7660 C', '7661 C', '7662 C', '7663 C', '7664 C', '7665 C', '7666 C', '2567 C', '2577 C', '2587 C', '2597 C', '2607 C', '2617 C', '2627 C', '263 C', '264 C', '265 C', '266 C', '267 C', '268 C', '269 C', '2635 C', '2645 C', '2655 C', '2665 C', '2685 C', '2695 C', '270 C', '271 C', '272 C', '273 C', '274 C', '275 C', '276 C', '2705 C', '2715 C', '2725 C', '2735 C', '2745 C', '2755 C', '2765 C', '7667 C', '7668 C', '7669 C', '7670 C', '7671 C', '7672 C', '7673 C', '7443 C', '7444 C', '7445 C', '7446 C', '7447 C', '7448 C', '7449 C', '7674 C', '7675 C', '7676 C', '7677 C', '7678 C', '7679 C', '7680 C', '663 C', '664 C', '665 C', '666 C', '667 C', '668 C', '669 C', '5315 C', '5305 C', '5295 C', '5285 C', '5275 C', '5265 C', '5255 C', '538 C', '537 C', '536 C', '535 C', '534 C', '533 C', '532 C', '7541 C', '7542 C', '7543 C', '7544 C', '7545 C', '7546 C', '7547 C', '552 C', '551 C', '550 C', '549 C', '548 C', '547 C', '546 C', '5455 C', '5445 C', '5435 C', '5425 C', '5415 C', '5405 C', '5395 C', '642 C', '643 C', '644 C', '645 C', '646 C', '647 C', '648 C', '649 C', '650 C', '651 C', '652 C', '653 C', '654 C', '655 C', '656 C', '657 C', '658 C', '659 C', '660 C', '661 C', '662 C', '7450 C', '7451 C', '7452 C', '7453 C', '7454 C', '7455 C', '7456 C', '2706 C', '2716 C', '2726 C', '2736 C', '2746 C', '2756 C', '2766 C', '2708 C', '2718 C', '2728 C', '2738 C', '2748 C', '2758 C', '2768 C', '2707 C', '2717 C', '2727 C', '2747 C', '2757 C', '2767 C', '277 C', '278 C', '279 C', '280 C', '281 C', '282 C', '283 C', '284 C', '285 C', '286 C', '287 C', '288 C', '289 C', '7681 C', '7682 C', '7683 C', '7684 C', '7685 C', '7686 C', '7687 C', '545 C', '544 C', '543 C', '542 C', '541 C', '540 C', '539 C', '290 C', '291 C', '292 C', '293 C', '294 C', '295 C', '296 C', '2905 C', '2915 C', '2925 C', '2935 C', '2945 C', '2955 C', '2965 C', '297 C', '298 C', '299 C', '300 C', '301 C', '302 C', '303 C', '7688 C', '7689 C', '7690 C', '7691 C', '7692 C', '7693 C', '7694 C', '2975 C', '2985 C', '2995 C', '3005 C', '3015 C', '3025 C', '3035 C', '7695 C', '7696 C', '7697 C', '7698 C', '7699 C', '7700 C', '7701 C', '7457 C', '7458 C', '7459 C', '7460 C', '7461 C', '7462 C', '7463 C', '304 C', '305 C', '306 C', '307 C', '308 C', '309 C', '635 C', '636 C', '637 C', '638 C', '639 C', '640 C', '641 C', '7702 C', '7703 C', '7704 C', '7705 C', '7706 C', '7707 C', '7708 C', '628 C', '629 C', '630 C', '631 C', '632 C', '633 C', '634 C', '310 C', '311 C', '312 C', '313 C', '314 C', '315 C', '316 C', '3105 C', '3115 C', '3125 C', '3135 C', '3145 C', '3155 C', '3165 C', '7709 C', '7710 C', '7711 C', '7712 C', '7713 C', '7714 C', '7715 C', '317 C', '318 C', '319 C', '320 C', '321 C', '322 C', '323 C', '7464 C', '7465 C', '7466 C', '7467 C', '7468 C', '7469 C', '7470 C', '7471 C', '7472 C', '7473 C', '7474 C', '7475 C', '7476 C', '7477 C', '5523 C', '5513 C', '5503 C', '5493 C', '5483 C', '5473 C', '5463 C', '7716 C', '7717 C', '7718 C', '7719 C', '7720 C', '7721 C', '7722 C', '324 C', '325 C', '326 C', '327 C', '328 C', '329 C', '330 C', '3242 C', '3252 C', '3262 C', '3272 C', '3282 C', '3292 C', '3302 C', '3245 C', '3255 C', '3265 C', '3275 C', '3285 C', '3295 C', '3305 C', '3248 C', '3258 C', '3268 C', '3278 C', '3288 C', '3298 C', '3308 C', '566 C', '565 C', '564 C', '563 C', '562 C', '561 C', '560 C', '573 C', '572 C', '571 C', '570 C', '569 C', '568 C', '567 C', '559 C', '558 C', '557 C', '556 C', '555 C', '554 C', '553 C', '5595 C', '5585 C', '5575 C', '5565 C', '5555 C', '5545 C', '5535 C', '5665 C', '5655 C', '5645 C', '5635 C', '5625 C', '5615 C', '5605 C', '5527 C', '5517 C', '5507 C', '5497 C', '5487 C', '5477 C', '5467 C', '621 C', '622 C', '623 C', '624 C', '625 C', '626 C', '627 C', '331 C', '332 C', '333 C', '334 C', '335 C', '336 C', '337 C', '338 C', '339 C', '340 C', '341 C', '342 C', '343 C', '7723 C', '7724 C', '7725 C', '7726 C', '7727 C', '7728 C', '7729 C', '3375 C', '3385 C', '3395 C', '3405 C', '3415 C', '3425 C', '3435 C', '344 C', '345 C', '346 C', '347 C', '348 C', '349 C', '350 C', '351 C', '352 C', '353 C', '354 C', '355 C', '356 C', '357 C', '7478 C', '7479 C', '7480 C', '7481 C', '7482 C', '7483 C', '7484 C', '7730 C', '7731 C', '7732 C', '7733 C', '7734 C', '7735 C', '7736 C', '7737 C', '7738 C', '7739 C', '7740 C', '7741 C', '7742 C', '7743 C', '358 C', '359 C', '360 C', '361 C', '362 C', '363 C', '364 C', '7485 C', '7486 C', '7487 C', '7488 C', '7489 C', '7490 C', '7491 C', '365 C', '366 C', '367 C', '368 C', '369 C', '370 C', '371 C', '372 C', '373 C', '374 C', '375 C', '376 C', '377 C', '378 C', '580 C', '579 C', '578 C', '577 C', '576 C', '575 C', '574 C', '5807 C', '5797 C', '5787 C', '5777 C', '5767 C', '5757 C', '5747 C', '5875 C', '5865 C', '5855 C', '5845 C', '5835 C', '5825 C', '5815 C', '5803 C', '5793 C', '5783 C', '5773 C', '5763 C', '5753 C', '5743 C', '7492 C', '7493 C', '7494 C', '7495 C', '7496 C', '7497 C', '7498 C', '7744 C', '7745 C', '7746 C', '7747 C', '7748 C', '7749 C', '7750 C', '379 C', '380 C', '381 C', '382 C', '383 C', '384 C', '385 C', '386 C', '387 C', '388 C', '389 C', '390 C', '391 C', '392 C', '587 C', '586 C', '585 C', '584 C', '583 C', '582 C', '581 C', '393 C', '394 C', '395 C', '396 C', '397 C', '398 C', '399 C', '3935 C', '3945 C', '3955 C', '3965 C', '3975 C', '3985 C', '3995 C', '600 C', '601 C', '602 C', '603 C', '604 C', '605 C', '606 C', '607 C', '608 C', '609 C', '610 C', '611 C', '612 C', '613 C', '461 C', '460 C', '459 C', '458 C', '457 C', '456 C', '455 C', '614 C', '615 C', '616 C', '617 C', '618 C', '619 C', '620 C', '7751 C', '7752 C', '7753 C', '7754 C', '7755 C', '7756 C', '7757 C', '7758 C', '7759 C', '7760 C', '7761 C', '7762 C', '7763 C', '7764 C', '7765 C', '7766 C', '7767 C', '7768 C', '7769 C', '7770 C', '7771 C', '4545 C', '4535 C', '4525 C', '4515 C', '4505 C', '4495 C', '4485 C', '454 C', '453 C', '452 C', '451 C', '450 C', '449 C', '448 C', '7499 C', '7500 C', '7501 C', '7502 C', '7503 C', '7504 C', '7505 C', '468 C', '467 C', '466 C', '465 C', '464 C', '463 C', '462 C', '7506 C', '7507 C', '7508 C', '7509 C', '7510 C', '7511 C', '7512 C', '719 C', '720 C', '721 C', '722 C', '723 C', '724 C', '725 C', '475 C', '474 C', '473 C', '472 C', '471 C', '470 C', '469 C', '726 C', '727 C', '728 C', '729 C', '730 C', '731 C', '732 C', '4685 C', '4675 C', '4665 C', '4655 C', '4645 C', '4635 C', '4625 C', '7513 C', '7514 C', '7515 C', '7516 C', '7517 C', '7518 C', '7519 C', '4755 C', '4745 C', '4735 C', '4725 C', '4715 C', '4705 C', '4695 C', '482 C', '481 C', '480 C', '479 C', '478 C', '477 C', '476 C', '7527 C', '7528 C', '7529 C', '7530 C', '7531 C', '7532 C', '7533 C', '7534 C', '7535 C', '7536 C', '7537 C', '7538 C', '7539 C', '7540 C', '427 C', '428 C', '429 C', '430 C', '431 C', '432 C', '433 C', '420 C', '421 C', '422 C', '423 C', '424 C', '425 C', '426 C', '441 C', '442 C', '443 C', '444 C', '445 C', '446 C', '447 C', '413 C', '414 C', '415 C', '416 C', '417 C', '418 C', '419 C', '400 C', '401 C', '402 C', '403 C', '404 C', '405 C', '406 C', '407 C', '408 C', '409 C', '410 C', '411 C', '412 C', '434 C', '435 C', '436 C', '437 C', '438 C', '439 C', '440 C', 'Warm Gray 1 C', 'Warm Gray 2 C', 'Warm Gray 3 C', 'Warm Gray 4 C', 'Warm Gray 5 C', 'Warm Gray 6 C', 'Warm Gray 7 C', 'Warm Gray 8 C', 'Warm Gray 9 C', 'Warm Gray 10 C', 'Warm Gray 11 C', 'Cool Gray 1 C', 'Cool Gray 2 C', 'Cool Gray 3 C', 'Cool Gray 4 C', 'Cool Gray 5 C', 'Cool Gray 6 C', 'Cool Gray 7 C', 'Cool Gray 8 C', 'Cool Gray 9 C', 'Cool Gray 10 C', 'Cool Gray 11 C', 'Black 2 C', 'Black 3 C', 'Black 4 C', 'Black 5 C', 'Black 6 C', 'Black 7 C']
let rVal = ['254', '255', '254', '249', '239', '206', '225', '187', '68', '16', '0', '0', '0', '45', '242', '252', '241', '191', '116', '157', '158', '0', '68', '255', '255', '255', '255', '234', '132', '133', '134', '139', '135', '139', '138', '255', '255', '249', '206', '214', '78', '0', '0', '0', '34', '246', '247', '252', '197', '175', '137', '245', '236', '238', '244', '242', '241', '203', '249', '251', '254', '255', '218', '170', '156', '250', '251', '253', '255', '201', '172', '137', '243', '243', '243', '242', '204', '160', '108', '248', '251', '255', '255', '198', '173', '136', '251', '253', '254', '255', '234', '181', '154', '255', '255', '209', '180', '115', '90', '75', '210', '183', '159', '150', '143', '125', '108', '253', '255', '255', '255', '222', '175', '116', '253', '255', '255', '255', '213', '153', '110', '242', '241', '241', '237', '207', '167', '113', '246', '240', '254', '230', '211', '220', '193', '189', '214', '219', '205', '173', '137', '119', '215', '211', '198', '182', '167', '158', '131', '252', '253', '253', '246', '234', '212', '190', '254', '255', '255', '255', '229', '190', '155', '239', '239', '236', '232', '203', '161', '96', '255', '255', '255', '185', '148', '101', '255', '255', '255', '255', '216', '166', '139', '255', '255', '255', '255', '227', '190', '115', '219', '224', '220', '220', '192', '134', '103', '255', '255', '255', '252', '220', '169', '131', '255', '255', '255', '250', '207', '150', '107', '196', '186', '175', '158', '146', '123', '92', '212', '192', '177', '157', '124', '107', '92', '209', '189', '179', '141', '131', '123', '103', '228', '225', '214', '194', '164', '130', '104', '221', '202', '188', '163', '134', '107', '88', '234', '192', '180', '171', '164', '154', '138', '236', '236', '234', '232', '218', '154', '101', '255', '255', '255', '224', '190', '129', '255', '255', '248', '238', '210', '175', '124', '252', '251', '244', '203', '164', '100', '198', '192', '183', '171', '147', '138', '128', '225', '198', '167', '158', '109', '99', '87', '230', '229', '224', '205', '176', '155', '101', '250', '252', '246', '228', '200', '166', '118', '236', '232', '223', '213', '186', '157', '134', '248', '246', '239', '228', '191', '155', '120', '245', '245', '239', '224', '197', '166', '138', '245', '247', '249', '248', '239', '224', '203', '242', '244', '242', '230', '210', '184', '158', '236', '231', '224', '206', '165', '134', '111', '249', '245', '240', '227', '206', '172', '125', '244', '224', '226', '181', '164', '151', '106', '214', '196', '193', '198', '188', '145', '126', '234', '229', '218', '165', '145', '108', '147', '147', '142', '115', '103', '88', '80', '239', '235', '223', '208', '170', '137', '103', '244', '242', '233', '198', '162', '132', '234', '230', '223', '217', '198', '174', '150', '229', '227', '222', '201', '176', '153', '124', '228', '220', '208', '190', '167', '137', '97', '235', '232', '228', '213', '132', '111', '87', '226', '220', '201', '181', '167', '155', '135', '233', '228', '215', '196', '180', '152', '137', '242', '241', '233', '220', '143', '127', '93', '233', '229', '218', '198', '122', '106', '81', '223', '219', '204', '176', '156', '135', '63', '241', '236', '228', '219', '197', '175', '128', '239', '226', '213', '200', '176', '158', '131', '234', '229', '221', '199', '187', '165', '128', '165', '168', '153', '138', '114', '106', '94', '231', '221', '201', '173', '152', '114', '235', '230', '226', '212', '147', '131', '97', '238', '204', '213', '178', '162', '159', '150', '215', '201', '172', '155', '135', '119', '101', '148', '162', '161', '142', '110', '106', '93', '213', '201', '186', '165', '100', '89', '75', '219', '208', '198', '175', '134', '102', '74', '216', '211', '191', '155', '126', '105', '81', '223', '215', '202', '181', '128', '112', '87', '214', '198', '140', '109', '100', '93', '81', '203', '184', '160', '132', '112', '103', '95', '153', '141', '122', '107', '101', '94', '92', '193', '167', '130', '92', '80', '71', '60', '215', '193', '144', '117', '95', '88', '81', '197', '173', '150', '125', '51', '46', '180', '149', '116', '36', '33', '32', '34', '167', '139', '104', '46', '40', '37', '32', '110', '104', '97', '86', '81', '76', '83', '221', '182', '167', '137', '93', '75', '65', '135', '124', '117', '111', '104', '86', '82', '229', '224', '198', '161', '124', '97', '63', '216', '198', '179', '141', '89', '64', '30', '197', '187', '162', '142', '27', '31', '28', '217', '164', '152', '118', '66', '37', '19', '185', '163', '141', '107', '0', '0', '7', '191', '183', '166', '122', '91', '79', '8', '209', '198', '155', '125', '94', '35', '0', '219', '206', '167', '125', '50', '0', '0', '221', '200', '177', '123', '64', '0', '0', '189', '137', '128', '123', '95', '58', '96', '203', '159', '72', '30', '23', '21', '20', '184', '92', '0', '6', '0', '0', '7', '195', '167', '48', '0', '0', '19', '171', '139', '65', '1', '0', '4', '146', '108', '0', '0', '0', '0', '12', '148', '103', '66', '56', '44', '29', '29', '198', '189', '164', '123', '0', '0', '0', '185', '155', '105', '0', '0', '0', '4', '141', '98', '0', '0', '0', '0', '0', '113', '65', '0', '0', '0', '0', '0', '70', '41', '0', '0', '0', '0', '1', '153', '91', '0', '0', '0', '0', '0', '123', '99', '78', '65', '52', '22', '0', '187', '113', '66', '0', '0', '0', '0', '154', '89', '0', '0', '0', '0', '164', '139', '78', '0', '0', '0', '0', '72', '0', '0', '0', '0', '0', '0', '184', '155', '119', '62', '0', '0', '0', '106', '5', '0', '0', '0', '0', '0', '104', '0', '0', '0', '0', '0', '0', '99', '0', '0', '0', '0', '0', '0', '177', '136', '45', '0', '0', '0', '0', '160', '64', '0', '0', '0', '0', '0', '126', '92', '39', '0', '72', '13', '36', '182', '171', '148', '127', '79', '17', '7', '0', '0', '0', '0', '0', '0', '0', '156', '100', '0', '0', '0', '0', '0', '113', '42', '0', '0', '0', '0', '0', '124', '44', '0', '0', '0', '0', '0', '109', '73', '0', '0', '0', '0', '3', '185', '161', '134', '107', '0', '0', '29', '181', '165', '152', '107', '0', '0', '23', '173', '154', '133', '111', '40', '32', '40', '191', '167', '146', '127', '92', '67', '24', '186', '176', '163', '148', '112', '94', '34', '188', '177', '157', '130', '93', '62', '24', '209', '183', '154', '120', '80', '40', '19', '167', '140', '60', '0', '0', '0', '143', '110', '0', '0', '0', '0', '17', '80', '0', '0', '0', '0', '0', '0', '122', '71', '0', '0', '0', '0', '21', '160', '145', '113', '0', '0', '4', '44', '162', '143', '128', '0', '0', '0', '33', '155', '38', '0', '0', '0', '39', '0', '75', '34', '0', '0', '40', '54', '57', '107', '72', '49', '58', '68', '74', '68', '173', '161', '108', '67', '80', '76', '74', '208', '188', '142', '120', '116', '113', '121', '194', '183', '164', '120', '100', '101', '84', '212', '205', '197', '151', '132', '122', '89', '196', '188', '183', '169', '120', '103', '78', '208', '198', '186', '162', '138', '109', '61', '210', '203', '192', '175', '160', '137', '85', '195', '179', '163', '137', '115', '94', '62', '191', '187', '156', '143', '118', '122', '91', '186', '171', '153', '136', '124', '114', '101', '226', '219', '206', '196', '168', '148', '120', '233', '227', '224', '208', '181', '154', '130', '227', '224', '219', '210', '183', '142', '98', '240', '237', '236', '225', '191', '173', '160', '243', '243', '239', '238', '187', '154', '104', '241', '240', '240', '237', '234', '225', '207', '235', '233', '230', '225', '215', '196', '179', '233', '228', '222', '217', '184', '162', '105', '220', '214', '208', '192', '172', '159', '138', '202', '207', '193', '160', '137', '115', '103', '212', '196', '145', '116', '93', '88', '83', '187', '180', '170', '143', '113', '99', '78', '213', '207', '197', '179', '153', '140', '97', '202', '191', '176', '155', '89', '82', '74', '241', '223', '217', '206', '168', '148', '129', '221', '211', '198', '185', '139', '116', '92', '239', '252', '225', '214', '198', '183', '166', '237', '231', '221', '200', '179', '147', '125', '243', '241', '240', '229', '184', '164', '105', '224', '217', '205', '181', '158', '119', '98', '224', '220', '205', '191', '173', '148', '79', '225', '213', '197', '153', '133', '109', '94', '215', '205', '192', '174', '149', '124', '91', '219', '211', '198', '170', '112', '98', '78', '214', '197', '183', '163', '122', '99', '71', '209', '183', '166', '167', '148', '142', '75', '208', '193', '162', '124', '91', '51', '29', '199', '178', '158', '137', '112', '84', '37', '190', '162', '145', '113', '80', '63', '55', '186', '168', '145', '126', '101', '81', '33', '196', '175', '157', '140', '119', '105', '196', '178', '151', '133', '116', '94', '56', '208', '193', '171', '123', '88', '69', '56', '215', '203', '191', '182', '172', '165', '150', '140', '131', '121', '110', '217', '208', '200', '187', '177', '167', '151', '136', '117', '99', '83', '51', '33', '49', '62', '16', '61']
let gVal = ['221', '215', '80', '66', '51', '0', '0', '41', '0', '6', '20', '133', '171', '41', '240', '174', '178', '155', '209', '231', '151', '154', '214', '233', '170', '114', '62', '39', '117', '113', '109', '111', '103', '99', '141', '217', '94', '56', '0', '37', '0', '35', '132', '176', '34', '235', '234', '227', '169', '152', '122', '225', '216', '212', '218', '205', '196', '160', '229', '225', '219', '209', '170', '138', '132', '224', '221', '218', '205', '151', '132', '115', '221', '213', '208', '169', '138', '116', '87', '224', '216', '200', '184', '146', '132', '107', '219', '215', '209', '199', '170', '133', '118', '198', '181', '144', '126', '83', '69', '61', '159', '139', '125', '113', '106', '98', '93', '210', '198', '191', '163', '124', '109', '83', '208', '197', '181', '158', '120', '96', '76', '199', '190', '180', '139', '127', '109', '92', '190', '179', '173', '166', '130', '134', '108', '155', '154', '138', '121', '100', '83', '81', '136', '131', '125', '114', '102', '106', '93', '200', '190', '170', '141', '118', '93', '77', '203', '194', '178', '130', '114', '106', '90', '209', '190', '161', '119', '96', '86', '61', '174', '143', '105', '71', '69', '56', '185', '160', '127', '106', '96', '85', '71', '190', '157', '127', '103', '82', '83', '56', '134', '126', '107', '88', '81', '74', '71', '163', '141', '106', '76', '68', '67', '57', '179', '134', '92', '70', '69', '56', '53', '98', '88', '92', '83', '76', '77', '71', '181', '125', '85', '67', '58', '61', '61', '65', '71', '61', '63', '65', '73', '66', '213', '187', '147', '110', '73', '59', '52', '188', '154', '138', '127', '103', '76', '61', '190', '156', '106', '92', '82', '106', '57', '195', '186', '167', '146', '41', '51', '48', '177', '128', '88', '60', '58', '49', '163', '141', '72', '39', '38', '39', '37', '175', '99', '54', '51', '52', '51', '110', '76', '49', '35', '39', '42', '47', '82', '53', '43', '42', '51', '50', '45', '186', '106', '78', '84', '74', '34', '29', '187', '155', '82', '0', '16', '25', '35', '199', '156', '70', '0', '12', '34', '38', '163', '117', '66', '0', '13', '39', '47', '182', '155', '74', '0', '0', '9', '21', '218', '206', '181', '144', '96', '62', '44', '212', '195', '172', '134', '91', '58', '42', '179', '130', '69', '0', '0', '31', '38', '159', '126', '78', '28', '15', '20', '34', '205', '98', '69', '37', '18', '27', '44', '201', '164', '103', '54', '32', '47', '45', '190', '109', '24', '0', '0', '29', '109', '64', '44', '46', '46', '45', '43', '149', '111', '25', '0', '0', '12', '33', '166', '119', '60', '0', '0', '11', '211', '188', '160', '134', '87', '37', '0', '206', '200', '190', '150', '108', '72', '40', '198', '182', '161', '132', '99', '59', '33', '190', '179', '169', '146', '52', '44', '41', '188', '169', '128', '92', '58', '50', '38', '205', '190', '163', '132', '107', '72', '60', '198', '189', '162', '134', '50', '48', '42', '196', '186', '165', '133', '62', '55', '47', '194', '183', '161', '124', '97', '75', '32', '167', '134', '93', '62', '41', '22', '34', '186', '119', '57', '0', '0', '0', '0', '184', '155', '127', '36', '22', '24', '39', '110', '61', '30', '27', '34', '42', '39', '186', '156', '100', '26', '29', '36', '198', '190', '172', '139', '50', '49', '44', '218', '174', '158', '136', '119', '92', '60', '169', '139', '79', '38', '24', '37', '49', '135', '120', '90', '58', '43', '52', '55', '194', '177', '156', '127', '47', '49', '48', '205', '190', '176', '149', '100', '67', '48', '200', '192', '165', '119', '84', '60', '42', '200', '185', '162', '128', '49', '47', '44', '191', '161', '71', '32', '38', '40', '40', '163', '132', '94', '50', '32', '30', '33', '145', '110', '65', '48', '50', '54', '78', '160', '123', '70', '6', '7', '10', '16', '198', '167', '99', '59', '37', '44', '45', '180', '150', '120', '85', '0', '26', '181', '149', '116', '19', '21', '23', '28', '164', '132', '91', '0', '0', '14', '21', '124', '110', '94', '82', '70', '65', '84', '218', '184', '162', '134', '71', '56', '39', '140', '127', '102', '80', '71', '61', '49', '225', '219', '188', '146', '105', '75', '42', '215', '196', '176', '137', '84', '58', '26', '207', '199', '178', '159', '54', '42', '31', '225', '188', '164', '134', '85', '55', '30', '211', '199', '185', '164', '61', '49', '43', '206', '201', '187', '153', '127', '117', '31', '221', '214', '184', '161', '138', '97', '46', '226', '217', '188', '155', '98', '58', '37', '229', '216', '201', '164', '126', '53', '26', '197', '171', '148', '166', '143', '93', '110', '211', '174', '92', '34', '28', '31', '27', '204', '136', '71', '3', '24', '30', '29', '215', '198', '127', '26', '30', '41', '202', '184', '143', '33', '32', '30', '193', '172', '114', '51', '48', '45', '35', '169', '135', '109', '94', '86', '79', '66', '218', '214', '200', '175', '60', '48', '38', '217', '203', '179', '61', '47', '40', '28', '200', '181', '156', '87', '76', '56', '38', '197', '182', '163', '94', '75', '59', '42', '152', '143', '118', '98', '85', '73', '66', '214', '194', '169', '119', '98', '79', '62', '167', '153', '135', '116', '101', '92', '87', '221', '178', '152', '134', '125', '85', '43', '219', '203', '181', '107', '88', '59', '219', '211', '195', '175', '149', '130', '103', '169', '156', '133', '112', '106', '97', '86', '221', '211', '197', '177', '147', '115', '95', '209', '195', '169', '146', '127', '103', '72', '210', '193', '174', '142', '119', '98', '79', '177', '167', '151', '133', '125', '118', '98', '228', '219', '204', '156', '140', '115', '95', '209', '193', '176', '163', '115', '95', '90', '221', '184', '153', '118', '122', '82', '76', '207', '199', '183', '169', '134', '94', '39', '150', '133', '118', '109', '99', '94', '81', '219', '204', '178', '134', '115', '104', '83', '219', '210', '191', '164', '133', '89', '76', '224', '213', '199', '179', '150', '120', '78', '205', '197', '171', '155', '130', '106', '70', '220', '214', '200', '187', '111', '89', '60', '227', '223', '219', '202', '129', '108', '63', '202', '190', '176', '162', '114', '92', '71', '206', '189', '172', '156', '127', '105', '48', '197', '189', '178', '165', '133', '116', '55', '201', '192', '176', '153', '121', '93', '51', '224', '205', '185', '159', '127', '92', '50', '230', '226', '219', '151', '123', '102', '214', '206', '179', '150', '122', '103', '87', '166', '150', '135', '123', '111', '104', '88', '225', '215', '195', '175', '119', '99', '71', '218', '214', '204', '154', '132', '106', '82', '228', '226', '224', '177', '150', '122', '87', '227', '208', '191', '183', '159', '93', '87', '149', '136', '122', '112', '97', '87', '85', '165', '162', '155', '145', '136', '119', '105', '220', '216', '194', '176', '158', '140', '119', '222', '225', '221', '214', '170', '153', '134', '225', '221', '214', '190', '167', '141', '98', '235', '234', '232', '215', '189', '154', '98', '214', '209', '206', '196', '157', '130', '91', '209', '200', '189', '165', '141', '113', '68', '206', '199', '187', '169', '153', '129', '80', '198', '185', '170', '144', '123', '103', '72', '204', '197', '175', '153', '136', '114', '98', '188', '173', '155', '141', '128', '115', '102', '232', '228', '220', '214', '173', '147', '113', '236', '233', '231', '223', '189', '149', '122', '228', '226', '222', '215', '191', '140', '93', '236', '233', '232', '224', '184', '164', '146', '234', '229', '223', '220', '166', '135', '92', '235', '233', '232', '224', '218', '205', '181', '228', '225', '222', '213', '200', '176', '155', '223', '215', '205', '199', '157', '142', '91', '213', '207', '200', '181', '159', '145', '123', '182', '176', '160', '134', '118', '102', '94', '195', '178', '133', '113', '100', '92', '84', '179', '169', '157', '126', '97', '89', '73', '203', '196', '183', '163', '133', '119', '79', '199', '187', '170', '148', '74', '71', '65', '230', '209', '200', '184', '153', '121', '96', '203', '188', '170', '151', '91', '79', '70', '219', '210', '184', '164', '137', '119', '99', '200', '183', '164', '130', '105', '77', '63', '207', '198', '191', '158', '97', '90', '63', '192', '180', '160', '129', '101', '66', '52', '198', '191', '167', '148', '124', '96', '44', '183', '162', '139', '85', '67', '79', '75', '196', '181', '163', '138', '108', '77', '52', '200', '187', '169', '128', '63', '59', '54', '210', '185', '169', '147', '104', '81', '55', '204', '176', '159', '172', '154', '144', '79', '211', '198', '170', '135', '103', '63', '37', '201', '180', '162', '141', '115', '88', '40', '198', '172', '157', '124', '87', '68', '58', '187', '169', '147', '127', '102', '83', '35', '191', '169', '150', '133', '110', '97', '188', '168', '140', '120', '102', '81', '47', '196', '178', '152', '100', '68', '53', '46', '210', '196', '184', '173', '163', '156', '140', '130', '120', '110', '98', '217', '208', '201', '188', '179', '168', '153', '139', '120', '102', '86', '47', '39', '38', '43', '24', '57']
let bVal = ['0', '0', '0', '58', '64', '88', '152', '187', '153', '159', '137', '202', '132', '38', '161', '187', '220', '222', '234', '215', '142', '206', '44', '0', '77', '118', '181', '194', '78', '77', '75', '78', '79', '75', '143', '0', '0', '34', '86', '152', '142', '156', '202', '139', '35', '97', '72', '0', '0', '0', '39', '164', '152', '132', '64', '0', '0', '82', '71', '34', '0', '0', '0', '0', '18', '83', '64', '36', '0', '0', '0', '34', '109', '78', '62', '0', '0', '0', '27', '142', '114', '69', '28', '20', '31', '37', '101', '87', '65', '44', '0', '0', '17', '0', '0', '0', '0', '29', '34', '42', '19', '32', '35', '38', '42', '46', '52', '110', '88', '63', '0', '0', '4', '28', '134', '110', '73', '27', '0', '23', '30', '92', '72', '52', '0', '0', '17', '42', '0', '35', '119', '93', '53', '51', '24', '96', '45', '6', '37', '51', '47', '53', '37', '43', '48', '51', '43', '56', '50', '155', '135', '99', '46', '0', '0', '0', '139', '123', '91', '0', '0', '20', '26', '159', '125', '84', '34', '21', '28', '32', '98', '28', '0', '0', '11', '25', '144', '106', '50', '19', '24', '35', '32', '159', '110', '65', '31', '5', '28', '29', '78', '60', '47', '42', '49', '51', '54', '139', '109', '57', '2', '5', '30', '33', '171', '116', '57', '22', '32', '33', '41', '45', '38', '55', '48', '46', '53', '56', '158', '89', '51', '44', '45', '46', '49', '36', '42', '38', '43', '44', '49', '48', '211', '180', '138', '96', '61', '52', '49', '176', '142', '126', '116', '97', '76', '62', '176', '131', '85', '87', '72', '79', '27', '178', '168', '148', '124', '28', '36', '36', '187', '139', '93', '49', '52', '47', '181', '161', '94', '55', '48', '47', '41', '192', '126', '76', '59', '58', '53', '78', '54', '44', '40', '44', '43', '45', '61', '39', '42', '43', '50', '49', '45', '168', '84', '57', '91', '90', '66', '50', '203', '179', '117', '43', '46', '46', '47', '205', '174', '97', '50', '47', '53', '51', '188', '153', '111', '70', '62', '67', '64', '205', '187', '129', '77', '62', '61', '56', '223', '215', '196', '165', '121', '82', '48', '215', '204', '185', '153', '115', '75', '47', '203', '169', '123', '55', '52', '65', '61', '201', '182', '152', '121', '105', '90', '72', '212', '135', '133', '85', '63', '47', '62', '202', '167', '132', '99', '75', '70', '64', '219', '177', '132', '80', '72', '69', '115', '84', '72', '74', '69', '64', '58', '207', '189', '149', '111', '97', '88', '70', '215', '198', '172', '126', '103', '85', '226', '216', '201', '186', '154', '115', '81', '219', '216', '210', '182', '150', '120', '85', '212', '201', '186', '163', '137', '103', '65', '203', '195', '187', '170', '78', '63', '50', '203', '191', '158', '128', '100', '89', '81', '208', '195', '171', '144', '122', '86', '71', '207', '200', '178', '153', '55', '53', '44', '199', '193', '173', '143', '58', '53', '46', '195', '187', '166', '131', '105', '82', '33', '220', '208', '191', '177', '155', '133', '95', '225', '205', '181', '161', '142', '126', '101', '228', '220', '211', '177', '163', '144', '108', '135', '114', '102', '97', '87', '91', '81', '228', '223', '207', '172', '151', '108', '223', '221', '215', '200', '142', '119', '81', '234', '208', '215', '185', '166', '192', '189', '227', '219', '198', '182', '157', '131', '101', '148', '156', '149', '128', '98', '96', '84', '216', '208', '197', '178', '108', '95', '72', '211', '199', '188', '166', '122', '90', '65', '209', '205', '184', '147', '117', '94', '68', '231', '228', '221', '209', '167', '138', '95', '221', '207', '153', '119', '103', '95', '79', '216', '203', '181', '155', '130', '117', '103', '164', '151', '131', '119', '121', '110', '99', '218', '202', '175', '140', '120', '104', '83', '230', '226', '205', '189', '159', '131', '109', '227', '220', '211', '199', '114', '71', '223', '210', '193', '95', '81', '71', '53', '224', '215', '199', '139', '113', '98', '71', '160', '159', '155', '148', '137', '132', '134', '232', '220', '195', '202', '119', '76', '59', '180', '171', '160', '145', '141', '130', '120', '230', '227', '208', '178', '146', '121', '86', '223', '210', '196', '165', '120', '96', '52', '218', '214', '200', '188', '93', '68', '42', '226', '194', '174', '146', '99', '70', '41', '220', '210', '202', '184', '76', '60', '49', '214', '211', '200', '172', '149', '139', '44', '230', '227', '211', '196', '180', '146', '93', '233', '229', '214', '193', '149', '112', '84', '237', '235', '232', '219', '201', '148', '112', '219', '227', '221', '222', '180', '174', '178', '235', '229', '199', '170', '143', '109', '77', '234', '218', '187', '141', '113', '98', '73', '238', '237', '226', '114', '96', '75', '233', '232', '222', '105', '91', '66', '233', '228', '206', '160', '135', '114', '64', '203', '183', '169', '157', '151', '145', '138', '231', '230', '225', '212', '113', '87', '58', '235', '235', '231', '165', '108', '85', '44', '232', '229', '222', '184', '151', '101', '62', '232', '230', '224', '184', '135', '92', '58', '203', '194', '168', '152', '135', '118', '106', '234', '231', '224', '200', '155', '113', '81', '188', '174', '160', '141', '127', '125', '118', '230', '201', '181', '191', '186', '140', '73', '232', '232', '226', '166', '124', '73', '232', '230', '224', '215', '200', '186', '160', '197', '189', '173', '150', '142', '127', '112', '225', '221', '213', '200', '178', '150', '131', '227', '222', '206', '188', '163', '127', '81', '223', '213', '199', '170', '139', '114', '89', '188', '181', '169', '155', '138', '128', '105', '227', '223', '211', '166', '149', '119', '97', '202', '172', '185', '173', '152', '134', '112', '211', '178', '137', '129', '123', '87', '90', '208', '202', '187', '174', '142', '103', '45', '143', '125', '114', '104', '91', '93', '81', '217', '201', '169', '117', '103', '94', '76', '212', '201', '179', '153', '120', '79', '69', '211', '196', '177', '152', '129', '100', '66', '184', '177', '142', '119', '100', '82', '56', '210', '202', '188', '174', '98', '76', '52', '216', '211', '206', '186', '109', '91', '53', '184', '170', '154', '135', '79', '64', '52', '194', '177', '160', '144', '113', '91', '40', '185', '176', '164', '150', '115', '97', '43', '197', '188', '172', '149', '117', '88', '47', '215', '194', '173', '144', '112', '77', '43', '215', '208', '192', '117', '95', '79', '189', '178', '136', '94', '83', '71', '64', '132', '108', '85', '75', '68', '69', '68', '191', '172', '137', '102', '73', '65', '52', '179', '172', '152', '68', '61', '56', '52', '184', '176', '167', '64', '57', '51', '50', '191', '124', '111', '79', '77', '56', '63', '96', '72', '62', '65', '64', '59', '66', '57', '63', '66', '63', '62', '60', '61', '145', '132', '74', '42', '47', '43', '41', '187', '148', '101', '75', '80', '73', '60', '137', '121', '94', '32', '11', '27', '35', '142', '128', '108', '0', '0', '1', '29', '164', '155', '149', '127', '74', '58', '49', '171', '155', '139', '105', '74', '46', '30', '158', '147', '135', '110', '88', '61', '37', '168', '149', '131', '100', '76', '56', '39', '128', '146', '136', '62', '29', '86', '54', '22', '35', '48', '48', '52', '55', '53', '104', '66', '0', '0', '0', '0', '33', '107', '53', '33', '0', '0', '0', '4', '141', '124', '112', '85', '16', '19', '32', '116', '57', '26', '0', '0', '0', '0', '93', '0', '0', '0', '0', '0', '32', '156', '145', '123', '75', '36', '0', '0', '154', '134', '119', '85', '38', '0', '0', '151', '126', '99', '86', '24', '42', '36', '154', '141', '131', '97', '60', '42', '25', '75', '35', '30', '41', '48', '53', '51', '4', '0', '44', '54', '57', '59', '53', '35', '31', '46', '53', '53', '57', '52', '159', '147', '131', '105', '66', '50', '37', '167', '152', '126', '95', '37', '39', '42', '178', '167', '158', '136', '104', '93', '64', '164', '141', '118', '91', '41', '40', '43', '178', '153', '127', '97', '63', '41', '27', '163', '138', '111', '66', '36', '17', '22', '179', '167', '155', '109', '37', '42', '35', '159', '143', '119', '80', '46', '18', '18', '173', '166', '136', '116', '89', '55', '29', '167', '134', '104', '43', '30', '71', '60', '183', '167', '146', '121', '88', '58', '39', '182', '168', '146', '102', '42', '42', '41', '196', '172', '154', '130', '85', '61', '41', '189', '156', '136', '162', '144', '137', '84', '212', '200', '173', '142', '112', '72', '45', '199', '178', '162', '141', '114', '90', '42', '196', '171', '157', '125', '89', '68', '54', '177', '158', '136', '116', '92', '74', '34', '182', '160', '141', '123', '100', '88', '183', '162', '135', '116', '97', '77', '45', '197', '182', '157', '105', '70', '54', '44', '203', '188', '175', '165', '154', '148', '131', '121', '111', '101', '89', '214', '206', '199', '188', '179', '170', '155', '141', '123', '106', '90', '33', '33', '29', '46', '32', '53']

const numberModifiers = {
  'thousand': 1000,
  'hundred': 100
}
const numbers = {
  'half': 0.5,
  'zero': 0,
  'one': 1,
  'two': 2,
  'three': 3,
  'four': 4,
  'five': 5,
  'six': 6,
  'seven': 7,
  'eight': 8,
  'nine': 9,
  'ten': 10,
  'eleven': 11,
  'twelve': 12,
  'thirteen': 13,
  'fourteen': 14,
  'fifteen': 15,
  'sixteen': 16,
  'seventeen': 17,
  'eighteen': 18,
  'nineteen': 19,
  'twenty': 20,
  'thirty': 30,
  'fourty': 40,
  'fifty': 50,
  'sixty': 60,
  'seventy': 70,
  'eighty': 80,
  'ninety': 90
}

function interpretSemanticNumber (numString) {
  let nums = numString.split('-')
  let i = 0
  let total = 0

  while (i < nums.length) {
    if (!Object.keys(numbers).includes(nums[i])) {
      // Probably the word 'and'
      i++
      continue
    }
    let val = numbers[nums[i]]

    // Is the next word a modifier?
    if (Object.keys(numberModifiers).includes(nums[i + 1])) {
      // Modify the number and skip the next word
      val *= numberModifiers[nums[i + 1]]
      i++
    }

    total += val
    i++
  }
  return total
}

function isSemanticNumber (numString) {
  let nums = numString.split('-')
  for (let n of nums) {
    if (Object.keys(numbers).includes(n)) return true
  }
  return false
}

function subSplit (arr, val) {
  let out = []
  for (let a of arr) {
    let b = a.split(val)
    for (let bB of b) {
      out.push(bB)
    }
  }
  return out
}

function replaceSemanticNumbersInString (inStr) {
  let outStr = inStr
  const vals = subSplit(subSplit(subSplit(inStr.split(' '), ','), '('), ')')

  for (let v of vals) {
    if (isSemanticNumber(v)) {
      outStr = outStr.replace(`${v} `, interpretSemanticNumber(v))
      outStr = outStr.replace(v, interpretSemanticNumber(v))
    }
  }
  return outStr
}

function normalise (numArray) {
  let highest = 0
  for (let nA of numArray) {
    if (nA > highest) highest = nA
  }
  return numArray.map(x => x / highest)
}

function cmykToCSS (cmykString) {
  // This isn't perfect, but it'll do
  const cmyk = normalise(cmykString.split(',').map(x => Number(x.trim())))

  const r = Math.floor(255 * (1 - cmyk[0]) * (1 - cmyk[3]))
  const g = Math.floor(255 * (1 - cmyk[1]) * (1 - cmyk[3]))
  const b = Math.floor(255 * (1 - cmyk[2]) * (1 - cmyk[3]))
  return `rgb(${r}, ${g}, ${b})`
}

function removeComments (cStr) {
  let cMatches = cStr.match(/(?:\/\*)(.*?)(?:\*\/)/ig)
  if (!cMatches) return cStr
  for (let c of cMatches) {
    cStr = cStr.replace(c, '')
  }
  return cStr
}

function pantoneToCSS (pantoneString, line, lineNumber) {
  if (!pantoneString.includes(' C')) {
    pantoneString = pantoneString.replace('C', ' C')
  }
  let pantoneId = pantones.indexOf(pantoneString)
  if (pantoneId === -1) {
    throwError(lineNumber, line, 'Argument error', 'Invalid PANTONE® swatch name')
    return 'rgb(255, 255, 255)'
  }
  return `rgb(${rVal[pantoneId]}, ${gVal[pantoneId]}, ${bVal[pantoneId]})`
}

class MoreCSSTranspiler {
  constructor (moreString) {
    this.styles = {}
    this.moreLines = moreString.split(/\r?\n/g)
  }

  transpile () {
    for (let i = 0; i < this.moreLines.length; i++) {
      this.transpileLine(i)
    }
    let cssOut = ''
    for (let s in this.styles) {
      cssOut = `${cssOut}\n${s} {\n`
      for (let sS of this.styles[s]) {
        cssOut = `${cssOut}${sS}\n`
      }
      cssOut = `${cssOut}}`
    }
    return cssOut
  }

  transpileLine (lineNumber) {
    let line = removeComments(this.moreLines[lineNumber])

    if (
      !(line.includes(':') && line.includes(';'))
    ) {
      // Don't think this is a MORE line
      return
    }

    if (
      line.includes('center') ||
      line.includes('color')
    ) {
      throwError(lineNumber, line, 'Style linting', 'American spelling')
    }

    let isImportant = !(line.includes('!unimportant'))
    line = line.replace('!unimportant', '').replace(';', '')

    // Find the split between the property and the selector
    let selSplit = line.split(':')[0].split(' ')

    let value = line.split(':')[1]
    if (
      value.includes('rgb') ||
      value.includes('#')
    ) {
      throwError(lineNumber, line, 'Style linting', 'Non CMYK or PANTONE® colour value.')
    }
    value = this.transpileValue(value, line, lineNumber)

    let property = (selSplit[selSplit.length - 1]).replace(/colour/g, 'color')
    let selector = selSplit.filter((x, i) => i !== selSplit.length - 1).join(' ')

    if (!Object.keys(this.styles).includes(selector)) {
      this.styles[selector] = []
    }

    this.styles[selector]
      .push(`${property}:${value} ${isImportant ? '!important' : ''};`)
  }

  transpileValue (value, line, lineNumber) {
    value = value.trim()
    value = replaceSemanticNumbersInString(value)
      .replace(/pixels/g, 'px').replace(/percent/g, '%').replace(/centre/g, 'center')
    if (value.includes('spot(')) {
      // PANTONE colour
      return pantoneToCSS(value.replace('spot(PANTONE ', '').replace(')', ''), line, lineNumber)
    }
    if (value.includes('cmyk(')) {
      // CMYK
      return cmykToCSS(value.replace('cmyk(', '').replace(')', ''))
    }
    return value
  }
}

window.MoreCSSTranspiler = MoreCSSTranspiler
